{"version":3,"file":"ng-zorro-antd-avatar.js","sources":["ng:/ng-zorro-antd/avatar/nz-avatar.component.ts","ng:/ng-zorro-antd/avatar/nz-avatar.module.ts"],"names":["tslib_1.__decorate"],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Platform } from '@angular/cdk/platform';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnChanges,\n  Output,\n  Renderer2,\n  SimpleChanges,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport {\n  NzConfigService,\n  NzShapeSCType,\n  NzSizeLDSType,\n  NzSizeMap,\n  NzUpdateHostClassService,\n  WithConfig\n} from 'ng-zorro-antd/core';\n\nconst NZ_CONFIG_COMPONENT_NAME = 'avatar';\n\n@Component({\n  selector: 'nz-avatar',\n  exportAs: 'nzAvatar',\n  templateUrl: './nz-avatar.component.html',\n  providers: [NzUpdateHostClassService],\n  preserveWhitespaces: false,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class NzAvatarComponent implements OnChanges {\n  @Input() @WithConfig(NZ_CONFIG_COMPONENT_NAME, 'circle') nzShape: NzShapeSCType;\n  @Input() @WithConfig(NZ_CONFIG_COMPONENT_NAME, 'default') nzSize: NzSizeLDSType | number;\n  @Input() nzText: string;\n  @Input() nzSrc: string;\n  @Input() nzSrcSet: string;\n  @Input() nzAlt: string;\n  @Input() nzIcon: string;\n  @Output() readonly nzError = new EventEmitter<Event>();\n\n  oldAPIIcon = true; // Make the user defined icon compatible to old API. Should be removed in 2.0.\n  hasText: boolean = false;\n  hasSrc: boolean = true;\n  hasIcon: boolean = false;\n  textStyles: {};\n\n  @ViewChild('textEl', { static: false }) textEl: ElementRef;\n\n  private el: HTMLElement = this.elementRef.nativeElement;\n  private prefixCls = 'ant-avatar';\n  private sizeMap: NzSizeMap = { large: 'lg', small: 'sm' };\n\n  constructor(\n    public nzConfigService: NzConfigService,\n    private elementRef: ElementRef,\n    private cd: ChangeDetectorRef,\n    private updateHostClassService: NzUpdateHostClassService,\n    private renderer: Renderer2,\n    private platform: Platform\n  ) {}\n\n  setClass(): this {\n    const classMap = {\n      [this.prefixCls]: true,\n      [`${this.prefixCls}-${this.sizeMap[this.nzSize]}`]: this.sizeMap[this.nzSize],\n      [`${this.prefixCls}-${this.nzShape}`]: this.nzShape,\n      [`${this.prefixCls}-icon`]: this.nzIcon,\n      [`${this.prefixCls}-image`]: this.hasSrc // downgrade after image error\n    };\n    this.updateHostClassService.updateHostClass(this.el, classMap);\n    this.cd.detectChanges();\n    return this;\n  }\n\n  imgError($event: Event): void {\n    this.nzError.emit($event);\n    if (!$event.defaultPrevented) {\n      this.hasSrc = false;\n      this.hasIcon = false;\n      this.hasText = false;\n      if (this.nzIcon) {\n        this.hasIcon = true;\n      } else if (this.nzText) {\n        this.hasText = true;\n      }\n      this.setClass().notifyCalc();\n      this.setSizeStyle();\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.hasOwnProperty('nzIcon') && changes.nzIcon.currentValue) {\n      this.oldAPIIcon = changes.nzIcon.currentValue.indexOf('anticon') > -1;\n    }\n    this.hasText = !this.nzSrc && !!this.nzText;\n    this.hasIcon = !this.nzSrc && !!this.nzIcon;\n    this.hasSrc = !!this.nzSrc;\n\n    this.setClass().notifyCalc();\n    this.setSizeStyle();\n  }\n\n  private calcStringSize(): void {\n    if (!this.hasText) {\n      return;\n    }\n\n    const childrenWidth = this.textEl.nativeElement.offsetWidth;\n    const avatarWidth = this.el.getBoundingClientRect().width;\n    const scale = avatarWidth - 8 < childrenWidth ? (avatarWidth - 8) / childrenWidth : 1;\n    this.textStyles = {\n      transform: `scale(${scale}) translateX(-50%)`\n    };\n    if (typeof this.nzSize === 'number') {\n      Object.assign(this.textStyles, {\n        lineHeight: `${this.nzSize}px`\n      });\n    }\n    this.cd.detectChanges();\n  }\n\n  private notifyCalc(): this {\n    // If use ngAfterViewChecked, always demands more computations, so......\n    if (this.platform.isBrowser) {\n      setTimeout(() => {\n        this.calcStringSize();\n      });\n    }\n    return this;\n  }\n\n  private setSizeStyle(): void {\n    const size = typeof this.nzSize === 'string' ? this.nzSize : `${this.nzSize}px`;\n    this.renderer.setStyle(this.el, 'width', size);\n    this.renderer.setStyle(this.el, 'height', size);\n    this.renderer.setStyle(this.el, 'line-height', size);\n    if (this.hasIcon) {\n      this.renderer.setStyle(this.el, 'font-size', `calc(${size} / 2)`);\n    }\n  }\n}\n","/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nimport { PlatformModule } from '@angular/cdk/platform';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NzIconModule } from 'ng-zorro-antd/icon';\n\nimport { NzAvatarComponent } from './nz-avatar.component';\n\n@NgModule({\n  declarations: [NzAvatarComponent],\n  exports: [NzAvatarComponent],\n  imports: [CommonModule, NzIconModule, PlatformModule]\n})\nexport class NzAvatarModule {}\n"]}